<div class="container py-4" *ngIf="room$ | async as room">
  <div class="card shadow">
    <div class="card-body">
      <h5 class="card-title text-warning mb-4">{{ room.name }}</h5>
      <div class="row">
        <div class="col-md-6">
          <div class="mb-3">
            <h6 class="text-secondary">Description:</h6>
            <p class="card-text">{{ room.description }}</p>
          </div>
        </div>
        <div class="col-md-6">
          <div class="mb-3">
            <h6 class="text-secondary">Details:</h6>
            <ul class="list-group">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <strong>Capacity:</strong>
                <span>{{ room.capacity }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <strong>Office name:</strong>
                <span>{{ room.office.name }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <strong>Location:</strong>
                <span>{{ room.office.country }}, {{ room.office.city }}, {{ room.office.address }}</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container py-4">
    <div class="row">
      <div class="col-md-6">
        <div class="mt-4">
          <strong>Available Slots:</strong>
          <h6 class="text-secondary">Select a team</h6>
          <select class="form-select custom-select-sm" aria-label="Default select example" *ngIf="teams$ | async as teams"
            [(ngModel)]="selectedTeam" (change)="handleTeamChange()">
            <option *ngFor="let team of teams" [ngValue]="team">{{ team.name }}</option>
          </select>

          <div *ngIf="selectedTeam">
            <h6 class="text-secondary mt-4">Select a day</h6>
            <mat-form-field>
              <input matInput [matDatepicker]="picker" (dateChange)="handleDateSelection($event)" placeholder="Choose a date">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>

          <ul class="list-group mt-4">
            <ng-container *ngIf="freeSlots$ | async as freeSlots">
              <li *ngFor="let slot of freeSlots; let index = index" class="list-group-item clickable-slot"
                [class.selected]="selectedSlot?.slot === slot?.slot"
                [class.free]="!slot?.booked"
                [class.booked]="slot?.booked"
                (click)="handleSlotClick(index, freeSlots)">
                {{ slot.slot }}
              </li>
            </ng-container>
          </ul>

          <div class="mt-4">
            <p *ngIf="messageError">{{messageError}}</p>
            <button type="button" class="btn btn-primary rounded-pill" (click)="updateSlot()" [class.btn-warning]="selectedSlot?.booked"
              [class.btn-dark]="!selectedSlot?.booked" [disabled]="!selectedSlot || !selectedTeam">{{!selectedSlot?.booked?
              'Unbook' : 'Book' }} slot</button>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <app-team-card [team]="selectedTeam"></app-team-card>
        <img [src]="room.imageUrl" alt="Room Image" style="max-width: 100%; height: auto;">
      </div>
    </div>
  </div>
